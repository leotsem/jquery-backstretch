/*
 * jQuery Backstretch
 * Version 1.2
 * http://srobbin.com/jquery-plugins/jquery-backstretch/
 *
 * Add a dynamically-resized background image to the page
 *
 * Copyright (c) 2010 Scott Robbin (srobbin.com)
 * Dual licensed under the MIT and GPL licenses.
*/

(function($){$.backstretch=function(src,options,callback){var settings={centeredX:true,centeredY:true,speed:0,maskedX:0,maskedY:0},rootElement=("onorientationchange"in window)?$(document):$(window),imgRatio,bgImg,bgWidth,bgHeight,bgOffset,bgCSS;if(options&&typeof options=="object")$.extend(settings,options);$(document).ready(_init);return this;function _init(){if(src){var container=$("<div />").attr("id","backstretch").css({left:settings.maskedX,top:settings.maskedY,position:"fixed",overflow:"hidden",zIndex:-9999}),img=$("<img />").css({position:"relative",display:"none"}).bind("load",function(e){var self=$(this);imgRatio=$(e.target).width()/$(e.target).height();_adjustBG(function(){self.fadeIn(settings.speed,function(){if(typeof callback=="function")callback();});});}).appendTo(container);$("body").prepend(container);img.attr("src",src);$(window).resize(_adjustBG);}}
function _adjustBG(fn){try{bgCSS={left:0,top:0}
bgWidth=rootElement.width()+(Math.abs(settings.maskedX)*2);bgHeight=(bgWidth/imgRatio)+(Math.abs(settings.maskedY)*2);if(bgHeight>=rootElement.height()){bgOffset=(bgHeight-rootElement.height())/2;if(settings.centeredY)$.extend(bgCSS,{top:"-"+bgOffset+"px"});}else{bgHeight=rootElement.height();bgWidth=bgHeight*imgRatio;bgOffset=(bgWidth-rootElement.width())/2;if(settings.centeredX)$.extend(bgCSS,{left:"-"+bgOffset+"px"});}
$("#backstretch img").width(bgWidth).height(bgHeight).css(bgCSS);}catch(err){}
if(typeof fn=="function")fn();}};})(jQuery);